<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8" />
  <title>R√©server une place</title>
  <link rel="stylesheet" href="styles.css" />
  <style>
    :root {
      --c-accent: #f47b5f;
      --c-accent-dark: #de5e42;
      --c-bg: #fff9f3;
      --c-text: #334155;
      --c-prune: #922c40;
      --radius: 10px;
      --shadow: 0 4px 12px rgb(0 0 0 / 0.08);
      --speed: 0.25s;
    }

    body {
      font-family: system-ui, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background: url('./img/bg-homeparking.png') no-repeat center center fixed;
      background-size: cover;
      background-attachment: fixed;
      color: var(--c-text);
      line-height: 1.45;
      padding: 3rem 1rem;
      margin: 0;
      animation: fade 0.6s ease;
    }

    main {
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      padding: 2rem;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      width: fit-content;
      max-width: 100%;
      margin: 0 auto;
      overflow-x: auto;
      /* ‚úÖ Ajout ici */
    }


    @keyframes fade {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
      }
    }

    h1 {
      font-size: clamp(1.6rem, 3vw, 2.2rem);
      font-weight: 700;
      text-align: center;
      color: var(--c-prune);
      margin-bottom: 2rem;
    }

    h2 {
      font-size: 1.3rem;
      color: var(--c-prune);
      margin-top: 2rem;
    }

    button,
    input,
    select {
      font: inherit;
      border: 1px solid #d3d7de;
      border-radius: var(--radius);
      padding: 0.45rem 0.8rem;
    }

    button {
      cursor: pointer;
      background: var(--c-accent);
      color: #fff;
      border: none;
      transition: transform var(--speed) ease, box-shadow var(--speed), background var(--speed);
    }

    button:hover {
      background: var(--c-accent-dark);
      transform: translateY(-2px);
      box-shadow: var(--shadow);
    }

    button:active {
      transform: translateY(0);
    }

    .secondary {
      background: #e2e8f0;
      color: var(--c-text);
    }

    .secondary:hover {
      background: #cbd5e1;
    }

    form {
      display: grid;
      gap: 0.7rem;
      background: #fff;
      padding: 1.5rem;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      width: min(480px, 100%);
      margin: 0 auto;
    }

    label {
      display: flex;
      flex-direction: column;
      gap: 0.2rem;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: #fff;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      margin-top: 1rem;
      max-width: 100%;
      overflow-x: auto;
      table-layout: auto;
      /* ou fixed selon ton besoin */
    }

    th,
    td {
      padding: 0.6rem 0.7rem;
      text-align: left;
      border-bottom: 1px solid #f0f0f0;
    }

    td:last-child {
      white-space: nowrap;
      width: 220px;
      /* ‚úÖ tu peux l‚Äôaugmenter un peu ici */
    }


    th {
      background: #fafafa;
      font-weight: 600;
      color: var(--c-prune);
    }

    tbody tr:hover {
      background: #fff1eb;
      transition: background 0.25s;
    }

    #logout-btn {
      float: right;
      margin-bottom: 1rem;
    }

    #confirmation {
      text-align: center;
      color: green;
      font-weight: bold;
      margin-top: 1rem;
    }

    @media (max-width: 768px) {

      form,
      main {
        padding: 1rem;
      }
    }

    #account-icon {
      position: fixed;
      top: 1rem;
      left: 1rem;
      z-index: 1000;
    }

    #account-icon img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      transition: transform 0.2s ease;
    }

    #account-icon img:hover {
      transform: scale(1.1);
    }

    tbody tr {
      animation: fadein 0.4s ease-in;
    }

    @keyframes fadein {
      from {
        opacity: 0;
        transform: translateY(5px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .btn-modif-res,
    .btn-suppr-res {
      padding: 6px 10px;
      margin: 2px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 1rem;
      display: inline-block;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;

    }

    .btn-modif-res {
      background-color: #facc15;
      color: #333;
    }

    .btn-suppr-res {
      background-color: #ef4444;
      color: #fff;
    }

    .btn-modif-res:hover {
      background-color: #eab308;
    }

    .btn-suppr-res:hover {
      background-color: #dc2626;
    }

    td:last-child {
      white-space: nowrap;
      width: 150px;
      /* Ajuste si besoin */
    }

    th:last-child,
    td:last-child {
      min-width: 120px;
      text-align: center;
    }

    .modif-mode {
      background-color: #38bdf8 !important;
      /* bleu clair */
      color: white;
    }

    .hidden {
      display: none !important;
    }

    .admin-assign {
      margin-top: 1em;
      padding: 1em;
      border: 1px solid #ccc;
      background: #f9f9f9;
      border-radius: 6px;
    }

    .btn-payer {
      background-color: #10b981;
      /* Vert √©meraude */
      color: white;
      padding: 6px 12px;
      font-size: 0.9rem;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .btn-payer:hover {
      background-color: #059669;
      /* Vert plus fonc√© au survol */
    }
  </style>
</head>

<body>
  <script type="module">
    import { auth } from './js/firebase-config.js';
    import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-auth.js";
    import { afficherTableauReservations } from './js/demo.js';

    const params = new URLSearchParams(window.location.search);
    const modifID = params.get("modif");
    if (modifID) {
      modifierReservation(modifID); // üõ† fonction d√©j√† d√©finie plus bas
    }


    onAuthStateChanged(auth, user => {
      if (!user) {
        window.location.href = "login.html";
      } else {
        document.body.style.display = "";
        document.getElementById('logout-btn').style.display = 'inline-block';
        afficherTableauReservations(user.email); // ‚úÖ Appel direct ici, une seule fois
      }
    });

    document.querySelectorAll("form").forEach(f => {
      f.addEventListener("submit", (e) => {
        if (!f.checkValidity()) {
          e.preventDefault();
          alert("‚ùå Veuillez corriger les erreurs du formulaire.");
        }
      });
    });
  </script>


  <div id="account-icon">
    <a href="client.html" id="account-icon">
      <img src="./img/account-icon.png" alt="Espace compte" /></a>
  </div>


  <main>
    <button class="secondary" id="logout-btn" style="display: none;">üîì Se d√©connecter</button>

    <h1>R√©servation Parking Voiturier</h1>

    <form id="demo-res">
      <input name="clientNom" placeholder="Nom" required />
      <input name="clientEmail" type="email" placeholder="Email" required />
      <input name="clientPhone" type="tel" placeholder="+33 612345678" pattern="^\+\d{1,4}\s?\d{6,14}$"
        title="Num√©ro au format international requis, ex : +33 612345678" required />
      <label>üìÖ Date de d√©part : <input name="dateDepart" type="date" required /></label>
      <label>‚úàÔ∏è Heure du vol : <input name="heureVol" type="time" required /></label>
      <label>üìÖ Date de retour : <input name="dateRetour" type="date" required /></label>
      <label>‚úàÔ∏è N¬∞ de vol : <input name="numeroVol" type="text" placeholder="ex : AF1234" autocomplete="off"
          required /></label>
      <label>üìç Lieu de RDV : <input name="lieuRDV" type="text" placeholder="ex : Terminal 2E CDG" required /></label>

      <select name="pack">
        <option>Standard</option>
        <option>Confort</option>
        <option>VIP</option>
      </select>
      <button class="secondary" type="submit">R√©server</button>
      <button type="button" id="annuler-modif" class="hidden">‚ùå Annuler</button>
    </form>

    <section id="mes-reservations" style="display: none;">
      <h2>Mes r√©servations</h2>
      <table>
        <thead>
          <tr>
            <th>D√©part</th>
            <th>Heure vol</th>
            <th>Heure RDV</th>
            <th>Num√©ro vol</th>
            <th>Retour</th>
            <th>Pack</th>
            <th>Lieu RDV</th>
            <th>Statut</th>
            <th>Actions</th> <!-- ‚úÖ AJOUT ICI -->

          </tr>
        </thead>
        <tbody id="table-client">
          <!-- lignes inject√©es -->
        </tbody>
      </table>
    </section>

    <!-- juste apr√®s le tableau dans accueil.html -->
    <div id="encart-admin"></div>


    <p id="confirmation"></p>
  </main>

  <!-- JS -->
  <script type="module" src="./js/demo.js"></script>
  <script type="module" src="./js/auth.js"></script>
  <!-- <script type="module" src="./js/client.js"></script> -->
</body>

</html>